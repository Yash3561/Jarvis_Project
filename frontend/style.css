/* =================================================================== */
/* Jarvis Co-Pilot V4 - The Final Polish                               */
/* =================================================================== */

:root {
    --bg-color: #0d1117;
    --primary-text: #e6edf3;
    --secondary-text: #8b949e;
    --border-color: #30363d;
    --user-bubble-bg: #21262d;
    --assistant-bubble-bg: #161b22;
    --accent-color: #58a6ff;
    --code-bg: #010409;
    --danger-color: #b62324;
    --input-bar-bg: #2a2d31;
    --font-main: 'Inter', 'Segoe UI', sans-serif;
    --font-code: 'JetBrains Mono', 'Fira Code', monospace;
}

* {
    box-sizing: border-box;
    scrollbar-width: thin;
    scrollbar-color: var(--assistant-bubble-bg) var(--bg-color);
}

body {
    background-color: var(--bg-color);
    color: var(--primary-text);
    font-family: var(--font-main);
    margin: 0;
    display: flex;
    flex-direction: row;
    height: 100vh;
    overflow: hidden;
}

/* --- Main Layout --- */
#sidebar {
    width: 260px;
    background-color: #010409;
    padding: 10px;
    display: flex;
    flex-direction: column;
    border-right: 1px solid var(--border-color);
    flex-shrink: 0;
}
#main-content {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    height: 100vh;
}
#new-chat-btn {
    background-color: var(--user-bubble-bg);
    border: 1px solid var(--border-color);
    color: var(--primary-text);
    padding: 10px;
    border-radius: 8px;
    cursor: pointer;
    text-align: left;
    margin-bottom: 20px;
    font-size: 14px;
    font-family: var(--font-main);
}
#new-chat-btn:hover { background-color: var(--assistant-bubble-bg); }
#chat-history-list { flex-grow: 1; overflow-y: auto; }

/* --- Header & Mute Button --- */
.header {
    position: relative;
    padding: 15px;
    text-align: center;
    border-bottom: 1px solid var(--border-color);
}
#mute-btn {
    position: absolute;
    top: 15px;
    right: 50px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: var(--secondary-text);
    transition: color 0.2s;
}
#mute-btn:hover { color: var(--primary-text); }
#mute-btn.muted { color: var(--danger-color); }

/* --- Chat & Message Bubbles --- */
#chat-container {
    flex-grow: 1;
    overflow-y: auto;
    padding: 20px;
}
.message-container {
    display: flex;
    margin-bottom: 25px;
    animation: fadeIn 0.3s ease-in-out;
    align-items: flex-start;
    position: relative;
}
.user-message { justify-content: flex-end; }
.assistant-message { justify-content: flex-start; }
.bubble {
    max-width: 85%;
    padding: 12px 18px;
    border-radius: 18px;
    line-height: 1.6;
    word-wrap: break-word;
}
.user-bubble { background-color: var(--user-bubble-bg); border-bottom-right-radius: 4px; }
.assistant-bubble { background-color: var(--assistant-bubble-bg); border-bottom-left-radius: 4px; }
.system-message { text-align: center; color: var(--secondary-text); font-style: italic; font-size: 12px; margin: 10px 0; }
.assistant-bubble p { margin-bottom: 12px; }

/* --- Code Blocks & Copy Button --- */
.assistant-bubble pre {
    margin: 10px -8px -8px -8px;
    padding: 12px;
    background-color: var(--code-bg);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    position: relative;
    font-family: var(--font-code);
}
.assistant-bubble code { font-family: var(--font-code); }

.code-copy-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: var(--assistant-bubble-bg);
    color: var(--primary-text);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 3px 10px;
    font-size: 12px;
    font-family: var(--font-main);
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.2s;
}
.assistant-bubble pre:hover .code-copy-btn { opacity: 1; }
.code-copy-btn:hover { background-color: var(--accent-color); }

/* --- Message Action Buttons (for non-code messages) --- */
.message-actions {
    display: flex;
    margin: 0 10px;
    opacity: 0;
    transition: opacity 0.2s;
    align-self: center;
}
.message-container:hover .message-actions {
    opacity: 1; /* Show the button when hovering the WHOLE ROW */
}
.action-btn { background: #2a2d31; border: 1px solid var(--border-color); color: #ccc; cursor: pointer; border-radius: 5px; padding: 4px 6px; font-size: 14px; margin-top: 4px; }
.action-btn:hover { background: #3a3d41; }
.action-btn.copied { color: #4caf50; }

/* --- Terminal --- */
#bottom-container { padding: 10px; border-top: 1px solid var(--border-color); }
#terminal-header { background-color: var(--user-bubble-bg); padding: 5px 10px; font-size: 12px; color: var(--secondary-text); cursor: pointer; border-top-left-radius: 8px; border-top-right-radius: 8px; }
#terminal-container { border: 1px solid var(--border-color); border-bottom: none; border-radius: 8px 8px 0 0; transition: max-height 0.3s ease-in-out; max-height: 0; overflow: hidden; }
#terminal-container:not(.hidden) { max-height: 200px; }
#terminal-output { height: 170px; overflow-y: auto; padding: 10px; font-family: var(--font-code); white-space: pre-wrap; background-color: var(--code-bg); }

/* --- Prompt Bar --- */
#input-area { display: flex; padding: 10px 0 0 0; align-items: flex-end; }
#input-box-wrapper { flex-grow: 1; display: flex; align-items: center; background-color: var(--input-bar-bg); border: 1px solid var(--border-color); border-radius: 24px; padding: 5px 5px 5px 20px; margin-right: 10px; }
#input-box { flex-grow: 1; background: transparent; border: none; color: var(--primary-text); font-size: 16px; resize: none; max-height: 200px; overflow-y: auto; padding-right: 10px; font-family: var(--font-main);}
#input-box:focus { outline: none; }
#input-box::placeholder { color: var(--secondary-text); }
#send-btn { background-color: var(--accent-color); color: white; border: none; border-radius: 50%; width: 36px; height: 36px; font-size: 20px; cursor: pointer; flex-shrink: 0; transition: background-color 0.2s; display: flex; align-items: center; justify-content: center; }
#send-btn:hover { filter: brightness(0.9); }
#mic-btn { background-color: var(--input-bar-bg); color: var(--secondary-text); border: 1px solid var(--border-color); border-radius: 50%; width: 46px; height: 46px; font-size: 24px; cursor: pointer; transition: background-color 0.2s; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
#mic-btn:hover { background-color: var(--assistant-bubble-bg); }
#mic-btn.listening { background-color: var(--danger-color); color: white; }
#mic-btn.thinking { animation: pulse 1.5s infinite; }

/* --- Animations & Notifications --- */
@keyframes pulse {
    0%   { background-color: var(--input-bar-bg); }
    50%  { background-color: var(--accent-color); }
    100% { background-color: var(--input-bar-bg); }
}
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.copy-notification { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background-color: #28a745; color: white; padding: 10px 20px; border-radius: 5px; z-index: 1000; font-family: var(--font-main); opacity: 0; animation: fadeInOut 2s ease-in-out; }
@keyframes fadeInOut {
    0%   { opacity: 0; transform: translate(-50%, -20px); }
    20%  { opacity: 1; transform: translate(-50%, 0); }
    80%  { opacity: 1; transform: translate(-50%, 0); }
    100% { opacity: 0; transform: translate(-50%, -20px); }
}

/* --- Pygments Code Styles --- */
.codehilite { background: #272822; color: #f8f8f2; border-radius: 8px; padding: 12px; font-family: 'Fira Code', monospace; }
.codehilite .c { color: #75715e } /* Comment */
.codehilite .err { color: #960050; background-color: #1e0010 } /* Error */
.codehilite .k { color: #66d9ef } /* Keyword */
.codehilite .l { color: #ae81ff } /* Literal */
.codehilite .n { color: #f8f8f2 } /* Name */
.codehilite .o { color: #f92672 } /* Operator */
.codehilite .p { color: #f8f8f2 } /* Punctuation */
.codehilite .ch { color: #75715e } /* Comment.Hashbang */
.codehilite .cm { color: #75715e } /* Comment.Multiline */
.codehilite .cp { color: #75715e } /* Comment.Preproc */
.codehilite .cpf { color: #75715e } /* Comment.PreprocFile */
.codehilite .c1 { color: #75715e } /* Comment.Single */
.codehilite .cs { color: #75715e } /* Comment.Special */
.codehilite .gd { color: #f92672 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gi { color: #a6e22e } /* Generic.Inserted */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #75715e } /* Generic.Subheading */
.codehilite .kc { color: #66d9ef } /* Keyword.Constant */
.codehilite .kd { color: #66d9ef } /* Keyword.Declaration */
.codehilite .kn { color: #f92672 } /* Keyword.Namespace */
.codehilite .kp { color: #66d9ef } /* Keyword.Pseudo */
.codehilite .kr { color: #66d9ef } /* Keyword.Reserved */
.codehilite .kt { color: #66d9ef } /* Keyword.Type */
.codehilite .ld { color: #e6db74 } /* Literal.Date */
.codehilite .m { color: #ae81ff } /* Literal.Number */
.codehilite .s { color: #e6db74 } /* Literal.String */
.codehilite .na { color: #a6e22e } /* Name.Attribute */
.codehilite .nb { color: #f8f8f2 } /* Name.Builtin */
.codehilite .nc { color: #a6e22e } /* Name.Class */
.codehilite .no { color: #66d9ef } /* Name.Constant */
.codehilite .nd { color: #a6e22e } /* Name.Decorator */
.codehilite .ni { color: #f8f8f2 } /* Name.Entity */
.codehilite .ne { color: #a6e22e } /* Name.Exception */
.codehilite .nf { color: #a6e22e } /* Name.Function */
.codehilite .nl { color: #f8f8f2 } /* Name.Label */
.codehilite .nn { color: #f8f8f2 } /* Name.Namespace */
.codehilite .nx { color: #a6e22e } /* Name.Other */
.codehilite .py { color: #f8f8f2 } /* Name.Property */
.codehilite .nt { color: #f92672 } /* Name.Tag */
.codehilite .nv { color: #f8f8f2 } /* Name.Variable */
.codehilite .ow { color: #f92672 } /* Operator.Word */
.codehilite .w { color: #f8f8f2 } /* Text.Whitespace */
.codehilite .mb { color: #ae81ff } /* Literal.Number.Bin */
.codehilite .mf { color: #ae81ff } /* Literal.Number.Float */
.codehilite .mh { color: #ae81ff } /* Literal.Number.Hex */
.codehilite .mi { color: #ae81ff } /* Literal.Number.Integer */
.codehilite .mo { color: #ae81ff } /* Literal.Number.Oct */
.codehilite .sa { color: #e6db74 } /* Literal.String.Affix */
.codehilite .sb { color: #e6db74 } /* Literal.String.Backtick */
.codehilite .sc { color: #e6db74 } /* Literal.String.Char */
.codehilite .dl { color: #e6db74 } /* Literal.String.Delimiter */
.codehilite .sd { color: #e6db74 } /* Literal.String.Doc */
.codehilite .s2 { color: #e6db74 } /* Literal.String.Double */
.codehilite .se { color: #ae81ff } /* Literal.String.Escape */
.codehilite .sh { color: #e6db74 } /* Literal.String.Heredoc */
.codehilite .si { color: #e6db74 } /* Literal.String.Interpol */
.codehilite .sx { color: #e6db74 } /* Literal.String.Other */
.codehilite .sr { color: #e6db74 } /* Literal.String.Regex */
.codehilite .s1 { color: #e6db74 } /* Literal.String.Single */
.codehilite .ss { color: #e6db74 } /* Literal.String.Symbol */
.codehilite .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #a6e22e } /* Name.Function.Magic */
.codehilite .vc { color: #f8f8f2 } /* Name.Variable.Class */
.codehilite .vg { color: #f8f8f2 } /* Name.Variable.Global */
.codehilite .vi { color: #f8f8f2 } /* Name.Variable.Instance */
.codehilite .vm { color: #f8f8f2 } /* Name.Variable.Magic */
.codehilite .il { color: #ae81ff } /* Literal.Number.Integer.Long */